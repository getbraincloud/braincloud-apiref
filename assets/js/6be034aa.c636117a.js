"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[12112],{3905:(e,t,a)=>{a.d(t,{Zo:()=>c,kt:()=>m});var r=a(67294);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function n(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?n(Object(a),!0).forEach((function(t){l(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):n(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,r,l=function(e,t){if(null==e)return{};var a,r,l={},n=Object.keys(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||(l[a]=e[a]);return l}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)a=n[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(l[a]=e[a])}return l}var s=r.createContext({}),p=function(e){var t=r.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},c=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},u="mdxType",h={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var a=e.components,l=e.mdxType,n=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),u=p(a),d=l,m=u["".concat(s,".").concat(d)]||u[d]||h[d]||n;return a?r.createElement(m,i(i({ref:t},c),{},{components:a})):r.createElement(m,i({ref:t},c))}));function m(e,t){var a=arguments,l=t&&t.mdxType;if("string"==typeof e||l){var n=a.length,i=new Array(n);i[0]=d;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o[u]="string"==typeof e?e:l,i[1]=o;for(var p=2;p<n;p++)i[p]=a[p];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}d.displayName="MDXCreateElement"},73326:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>u,frontMatter:()=>n,metadata:()=>o,toc:()=>p});var r=a(87462),l=(a(67294),a(3905));const n={title:"MatchMaking - How To Find Players",date:"2015-09-22"},i=void 0,o={unversionedId:"learn/portal-tutorials/matchmaking-how-to-find-players/index",id:"learn/portal-tutorials/matchmaking-how-to-find-players/index",title:"MatchMaking - How To Find Players",description:"Overview",source:"@site/docs/learn/5_portal-tutorials/6_matchmaking-how-to-find-players/index.md",sourceDirName:"learn/5_portal-tutorials/6_matchmaking-how-to-find-players",slug:"/learn/portal-tutorials/matchmaking-how-to-find-players/",permalink:"/braincloud-apiref/learn/portal-tutorials/matchmaking-how-to-find-players/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/learn/5_portal-tutorials/6_matchmaking-how-to-find-players/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1672679892,formattedLastUpdatedAt:"Jan 2, 2023",frontMatter:{title:"MatchMaking - How To Find Players",date:"2015-09-22"},sidebar:"learnSidebar",previous:{title:"Marketplace Configuration",permalink:"/braincloud-apiref/learn/portal-tutorials/marketplace-configuration/"},next:{title:"2FA for Team Members",permalink:"/braincloud-apiref/learn/portal-tutorials/two-factor-authentication-for-team-members/"}},s={},p=[{value:"Overview",id:"overview",level:2},{value:"Finding Players",id:"finding-players",level:2},{value:"Portal Setup",id:"portal-setup",level:3},{value:"BrainCloudClient API",id:"braincloudclient-api",level:3},{value:"Player Eligibility",id:"player-eligibility",level:2},{value:"Player Session",id:"player-session",level:3},{value:"Player Rating",id:"player-rating",level:3},{value:"Player Shield",id:"player-shield",level:3},{value:"Filtering\xa0Player Eligibility With Cloud Code",id:"filteringplayer-eligibility-with-cloud-code",level:2}],c={toc:p};function u(e){let{components:t,...n}=e;return(0,l.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"overview"},"Overview"),(0,l.kt)("p",null,"The ",(0,l.kt)("a",{parentName:"p",href:"/api/capi/matchmaking"},"MatchMaking")," API is used to find players for multiplayer matches. Once a player has been found using the MatchMaking API, that player can be used for starting a match using either the ",(0,l.kt)("a",{parentName:"p",href:"/api/capi/onewaymatch"},"BrainCloudOneWayMatch")," API\xa0or the ",(0,l.kt)("a",{parentName:"p",href:"/api/capi/asyncmatch"},"BrainCloudAsyncMatch")," API. For an overview of the different types of multiplayer matches please refer to the ",(0,l.kt)("a",{parentName:"p",href:"/learn/key-concepts/multiplayer/"},"Multiplayer")," documentation."),(0,l.kt)("h2",{id:"finding-players"},"Finding Players"),(0,l.kt)("p",null,"In order for players to be eligible for MatchMaking\xa0your app must do the following:"),(0,l.kt)("h3",{id:"portal-setup"},"Portal Setup"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Click the Matchmaking page, under ",(0,l.kt)("strong",{parentName:"li"},"Design | Multiplayer | Matchmaking")),(0,l.kt)("li",{parentName:"ul"},'Check the "Matchmaking Enabled" option')),(0,l.kt)("p",null,(0,l.kt)("a",{target:"_blank",href:a(5041).Z},(0,l.kt)("img",{src:a(33843).Z,width:"948",height:"587"}))),(0,l.kt)("h3",{id:"braincloudclient-api"},"BrainCloudClient API"),(0,l.kt)("p",null,"After enabling MatchMaking in the brainCloud portal, you also need to enable MatchMaking for your player. When you've authenticated as the player\xa0you will need to:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Call ",(0,l.kt)("a",{parentName:"li",href:"/api/capi/matchmaking/enablematchmaking"},"MatchMaking.EnableMatchMaking")," to allow the player to be considered for matches"),(0,l.kt)("li",{parentName:"ul"},"Optionally set a player rating. See below for more information on player ratings")),(0,l.kt)("p",null,"Your player should now be considered for matches."),(0,l.kt)("h2",{id:"player-eligibility"},"Player Eligibility"),(0,l.kt)("p",null,"There are a number of factors which affect player eligibility for MatchMaking."),(0,l.kt)("h3",{id:"player-session"},"Player Session"),(0,l.kt)("p",null,'If a player has a current session with brainCloud, they are by default ineligible for a match. This behavior can be modified by setting the\xa0"Allow attack while online" flag to true in the portal MatchMaking section.'),(0,l.kt)("p",null,"Note that while developing/debugging, it may be useful to set\xa0this flag to true - especially when using the API explorer to test the functionality. Otherwise, players who have a current session will be ignored for MatchMaking. Players will have to explicitly log out from brainCloud to be eligible for matches, or wait for their session to timeout (default is 20 minutes - configurable in the portal)."),(0,l.kt)("h3",{id:"player-rating"},"Player Rating"),(0,l.kt)("p",null,"All players in the system have a rating. The initial value can be specified in the portal MatchMaking section. The player rating can also be affected through the MatchMaking API functions ",(0,l.kt)("a",{parentName:"p",href:"/api/capi/matchmaking/incrementplayerrating"},"IncrementPlayerRating")," and\xa0",(0,l.kt)("a",{parentName:"p",href:"/api/capi/matchmaking/decrementplayerrating"},"DecrementPlayerRating"),"."),(0,l.kt)("p",null,'When a request is made through MatchMaking to GetOneWayPlayers, a "rangeDelta" parameter is supplied which limits the range of player ratings that are eligible, in relation to the currently authenticated player\'s rating.'),(0,l.kt)("p",null,"To illustrate this point, let's assume the following ratings:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Player A 1000"),(0,l.kt)("li",{parentName:"ul"},"Player B 1100"),(0,l.kt)("li",{parentName:"ul"},"Player C\xa0850")),(0,l.kt)("p",null,"If player A requests matches with a rangeDelta of 100, \xa0only player B will be eligible."),(0,l.kt)("p",null,"You can also request your MatchMaking details by calling the Read API."),(0,l.kt)("h3",{id:"player-shield"},"Player Shield"),(0,l.kt)("p",null,"Players in brainCloud can turn on a shield which prevents them from being matched. The MatchMaking API exposes functions to:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"TurnShieldOn"),(0,l.kt)("li",{parentName:"ul"},"TurnShieldOff"),(0,l.kt)("li",{parentName:"ul"},"TurnShieldOnFor (with the caller supplying a time in minutes)")),(0,l.kt)("p",null,"You can also query the remaining shield time by calling\xa0",(0,l.kt)("a",{parentName:"p",href:"/api/capi/matchmaking/getshieldexpiry"},"GetShieldExpiry"),"."),(0,l.kt)("h2",{id:"filteringplayer-eligibility-with-cloud-code"},"Filtering\xa0Player Eligibility With Cloud Code"),(0,l.kt)("p",null,"brainCloud supports filtering players by custom cloud scripts. In order to filter players using cloud code,\xa0follow these steps:"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Navigate to Edit Scripts in the Cloud Code section of the portal"),(0,l.kt)("li",{parentName:"ul"},'Create a cloud script - we\'ll call ours "MATCHMAKING_FILTER"',(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"Client Callable should be set to false"))),(0,l.kt)("li",{parentName:"ul"},'Below is an example matchmaking filter script. Note that the return value is true or false depending on whether the player should be matched. Note also the two input parameters in the "data" variable',(0,l.kt)("ul",{parentName:"li"},(0,l.kt)("li",{parentName:"ul"},"matchCandidate - The player object. This returns the same JSON as the MatchMaking.Read API call (see below)."),(0,l.kt)("li",{parentName:"ul"},"extraParms - The JSON extraParms object sent in the GetOneWayPlayersFilter API method. This is defined by the API method caller and can be used to help drive the custom filter results.")))),(0,l.kt)("p",null,(0,l.kt)("a",{target:"_blank",href:a(39639).Z},(0,l.kt)("img",{src:a(76631).Z,width:"1054",height:"493"}))),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'var matchCandidate = data["matchCandidate"];\nvar extraParms    = data["extraParms"];\n\nvar retval = false;\n\nvar playerID = matchCandidate["playerId"];\nvar otherPlayerSession = bridge.getSessionForProfile(playerID);\n\n// Now you can use the "otherPlayerSession" to execute API calls as that user.\n// For instance you could check some of their entity data or verify that they\n// have certain statistics that match the data in extraParams.\n\n// retVal of false indicates this player is not valid for matching\nretval;\n')),(0,l.kt)("p",null,'For reference, the MatchMaking matchCandidate object is similar to the following (returns the same fields as the "findPlayers" API):'),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'{\n "matchCandidate": {\n  "playerId": "89a0e12b-d910-4f5a-9e20-206017849754",\n  "playerName": "",\n  "pictureUrl": null,\n  "summaryFriendData": null,\n  "playerRating": 0,\n }\n}\n')))}u.isMDXComponent=!0},5041:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/files/2018-06-20_19-47-01-7a640ed059ac77919651aa95a3237a9f.png"},39639:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/files/2018-06-20_19-51-23-9b3cf5f7e442aa15a592af400faf598f.png"},33843:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/2018-06-20_19-47-01-7a640ed059ac77919651aa95a3237a9f.png"},76631:(e,t,a)=>{a.d(t,{Z:()=>r});const r=a.p+"assets/images/2018-06-20_19-51-23-9b3cf5f7e442aa15a592af400faf598f.png"}}]);