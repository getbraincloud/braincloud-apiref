"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[65365],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>m});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=a.createContext({}),s=function(e){var t=a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return a.createElement(c.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=s(n),h=r,m=p["".concat(c,".").concat(h)]||p[h]||d[h]||i;return n?a.createElement(m,o(o({ref:t},u),{},{components:n})):a.createElement(m,o({ref:t},u))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,o=new Array(i);o[0]=h;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l[p]="string"==typeof e?e:r,o[1]=l;for(var s=2;s<i;s++)o[s]=n[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},71379:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>p,frontMatter:()=>i,metadata:()=>l,toc:()=>s});var a=n(87462),r=(n(67294),n(3905));const i={title:"External Authentication",date:"2015-05-06"},o=void 0,l={unversionedId:"learn/key-concepts/authentication/external-authentication/index",id:"learn/key-concepts/authentication/external-authentication/index",title:"External Authentication",description:"brainCloud provides support for authenticating users via an external directory. This is done by implementing a custom script that acts as the integration glue between brainCloud and the\xa0external directory.",source:"@site/docs/learn/1_key-concepts/authentication/external-authentication/index.md",sourceDirName:"learn/1_key-concepts/authentication/external-authentication",slug:"/learn/key-concepts/authentication/external-authentication/",permalink:"/braincloud-apiref/learn/key-concepts/authentication/external-authentication/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/learn/1_key-concepts/authentication/external-authentication/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1672679892,formattedLastUpdatedAt:"Jan 2, 2023",frontMatter:{title:"External Authentication",date:"2015-05-06"},sidebar:"learnSidebar",previous:{title:"Email Authentication",permalink:"/braincloud-apiref/learn/key-concepts/authentication/email-authentication/"},next:{title:"Shared Accounts",permalink:"/braincloud-apiref/learn/key-concepts/authentication/shared-accounts/"}},c={},s=[{value:"Creating the Script",id:"creating-the-script",level:4},{value:"Portal Configuration",id:"portal-configuration",level:4},{value:"Client Call",id:"client-call",level:4},{value:"Advanced",id:"advanced",level:4}],u={toc:s};function p(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"brainCloud provides support for authenticating users via an external directory. This is done by implementing a custom script that acts as the integration ",(0,r.kt)("em",{parentName:"p"},"glue")," between brainCloud and the\xa0external directory."),(0,r.kt)("h4",{id:"creating-the-script"},"Creating the Script"),(0,r.kt)("p",null,'The first thing to do is write the script. This is done via the Cloud Code/Edit Scripts tab of the portal. The script must not be client callable. The parameter names for script data input are\xa0"externalId" and "authenticationToken". These parameters will be passed to the script by the client API authentication method. The script must return a boolean true or false to indicate success or failure.'),(0,r.kt)("p",null,"Here's an example:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-js"},'// Grab the input parameters\n\napiToken = data.authenticationToken;\nexternalId = data.externalId;\n\n// Create a proxy to the service\nhttpProxy = bridge.getHttpClientServiceProxy();\n\n// Create an empty query object\nquery = {};\n// Setup the header\nheaders = {};\nheaders.ExternAPIToken = apiToken;\n\n// make the web call\nresult = httpProxy.getResponseJson("externServiceName","v1/Users/Me", query, headers);\n\n// Evaluate the result and return\nvar retval = false;\nvar bcstatus = result.status;\nif (bcstatus === 200)\n{\n    bcdata = result.data;\n    restStatus = bcdata.status;\n    if (restStatus == 200)\n    {\n        jsondata = bcdata.json;\n        username = jsondata.UserName;\n        retval = (username === externalId);\n    }\n}\nretval;\n')),(0,r.kt)("h4",{id:"portal-configuration"},"Portal Configuration"),(0,r.kt)("p",null,"The script to run for a particular external authentication type must be configured via Authentication/External tab in the portal. You must use this area to associate an external authentication name with a script. \xa0The previously created script name should appear in the drop-down on this page when you add an entry."),(0,r.kt)("p",null,"You must also configure\xa0the url you want to access in the script via the Cloud Code/Web Services tab in the portal."),(0,r.kt)("h4",{id:"client-call"},"Client Call"),(0,r.kt)("p",null,"Now you can make an authentication call from a client app or via the Cloud Code/API Explorer tab in the portal. You need to set the ",(0,r.kt)("inlineCode",{parentName:"p"},"authenticationType"),' parameter to "External" and the ',(0,r.kt)("inlineCode",{parentName:"p"},"externalAuthName")," parameter to the value you used to identify the script in the Authentication/External tab in the portal."),(0,r.kt)("h4",{id:"advanced"},"Advanced"),(0,r.kt)("p",null,"Beginning with Release 4.2, External Authentication scripts have been enhanced to support returning of a JSON object with additional options:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"valid"),": boolean - indicates whether authentication was successful"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"externalIdOverride"),': "string" (optional) - tells the system to store the override string provided instead of the contents of the ',(0,r.kt)("inlineCode",{parentName:"li"},"externalId")," field passed into the Authenticate call. This is useful for cases where the externalId passed in can change (like an email used for logging in) - so that the system stores a non-changeable id (like an account number)"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"useProfileId"),': "string" (optional) - tells the system to use the specified ',(0,r.kt)("inlineCode",{parentName:"li"},"profileId")," to look up the user's account. If specified, the external identity will not be persisted against the user's account"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"authPayload"),": JSON map - allows the auth script to return additional information to the client for ",(0,r.kt)("em",{parentName:"li"},"successful")," logins"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("inlineCode",{parentName:"li"},"extraErrorJson"),": JSON map - allows the auth script to return additional error context to the client for ",(0,r.kt)("em",{parentName:"li"},"unsuccessful")," logins")))}p.isMDXComponent=!0}}]);