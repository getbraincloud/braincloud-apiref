"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[58711],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>m});var r=a(67294);function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,r,n=function(e,t){if(null==e)return{};var a,r,n={},l=Object.keys(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)a=l[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}var o=r.createContext({}),c=function(e){var t=r.useContext(o),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},d=function(e){var t=c(e.components);return r.createElement(o.Provider,{value:t},e.children)},p="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var a=e.components,n=e.mdxType,l=e.originalType,o=e.parentName,d=s(e,["components","mdxType","originalType","parentName"]),p=c(a),h=n,m=p["".concat(o,".").concat(h)]||p[h]||u[h]||l;return a?r.createElement(m,i(i({ref:t},d),{},{components:a})):r.createElement(m,i({ref:t},d))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var l=a.length,i=new Array(l);i[0]=h;var s={};for(var o in t)hasOwnProperty.call(t,o)&&(s[o]=t[o]);s.originalType=e,s[p]="string"==typeof e?e:n,i[1]=s;for(var c=2;c<l;c++)i[c]=a[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,a)}h.displayName="MDXCreateElement"},47890:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>o,contentTitle:()=>i,default:()=>p,frontMatter:()=>l,metadata:()=>s,toc:()=>c});var r=a(87462),n=(a(67294),a(3905));const l={title:"Rewards Handling",date:"2015-11-05"},i=void 0,s={unversionedId:"learn/key-concepts/gamification/rewards/index",id:"learn/key-concepts/gamification/rewards/index",title:"Rewards Handling",description:"Rewards are awarded as a result of server events triggered by the client application.",source:"@site/docs/learn/1_key-concepts/gamification/rewards/index.md",sourceDirName:"learn/1_key-concepts/gamification/rewards",slug:"/learn/key-concepts/gamification/rewards/",permalink:"/braincloud-apiref/learn/key-concepts/gamification/rewards/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/learn/1_key-concepts/gamification/rewards/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1672679892,formattedLastUpdatedAt:"Jan 2, 2023",frontMatter:{title:"Rewards Handling",date:"2015-11-05"},sidebar:"learnSidebar",previous:{title:"Gamification",permalink:"/braincloud-apiref/learn/key-concepts/gamification/"},next:{title:"Monetization",permalink:"/braincloud-apiref/learn/key-concepts/monetization/"}},o={},c=[{value:"How to handle rewards",id:"how-to-handle-rewards",level:2},{value:"Handling Rewards in the API callback",id:"handling-rewards-in-the-api-callback",level:3},{value:"Rewards JSON\xa0format",id:"rewards-jsonformat",level:4},{value:"Handling Rewards in the RewardsCallback interface",id:"handling-rewards-in-the-rewardscallback-interface",level:3},{value:"Attaching The Rewards Callback",id:"attaching-the-rewards-callback",level:4},{value:"Reward Callback JSON format",id:"reward-callback-json-format",level:4}],d={toc:c};function p(e){let{components:t,...a}=e;return(0,n.kt)("wrapper",(0,r.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("p",null,"Rewards are awarded as a result of server events triggered by the client application."),(0,n.kt)("p",null,"In general, a reward can consist of any or all of the following:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"experience points"),(0,n.kt)("li",{parentName:"ul"},"virtual currency"),(0,n.kt)("li",{parentName:"ul"},"player statistics"),(0,n.kt)("li",{parentName:"ul"},"global game statistics"),(0,n.kt)("li",{parentName:"ul"},"an achievement")),(0,n.kt)("p",null,"The valid components of a reward are dictated by the server design of the reference data entities. Of the reward components above, all except global game statistics are awarded directly to the player. The global game statistics component is applied to the statistics tracked by the game itself and can affect the entire game and all players in the game."),(0,n.kt)("p",null,"Rewards are awarded as a result of the client application triggering certain server events. Awarding the rewards associated with the server event may result in new player accomplishments (milestone achievements, quest completions, and higher experience levels)."),(0,n.kt)("p",null,"Accomplishments can also have rewards associated with them. When rewards are awarded by the server, the player\u2019s state is iteratively evaluated to see if the reward has resulted in any further rewards. These rewards are processed until no further rewards result."),(0,n.kt)("h2",{id:"how-to-handle-rewards"},"How to handle rewards"),(0,n.kt)("p",null,"Several brainCloud APIs can return rewards to the user.\xa0App developers can choose to present the rewards to the player as they occur. In order to do this, rewards can be handled in two ways:"),(0,n.kt)("ol",null,(0,n.kt)("li",{parentName:"ol"},"Parsed directly in the API callback return JSON"),(0,n.kt)("li",{parentName:"ol"},"Using the RewardsCallback interface")),(0,n.kt)("h3",{id:"handling-rewards-in-the-api-callback"},"Handling Rewards in the API callback"),(0,n.kt)("p",null,"To handle rewards in the API callback, you first need to know which API calls will generate rewards. The list of APIs is as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/api/capi/authentication"},'BrainCloudAuthentication - all of the "Authenticate" APIs')),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/api/capi/playerstats/incrementuserstats"},"BrainCloudPlayerStatistics.IncrementPlayerStats()")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/api/capi/playerstats/incrementexperiencepoints"},"BrainCloudPlayerStatistics.IncrementExperiencePoints()")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/api/capi/playerstatsevent/triggerstatsevent"},"BrainCloudPlayerStatisticsEvent.TriggerPlayerStatisticsEvent()")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"/api/capi/playerstatsevent/triggerstatsevents"},"BrainCloudPlayerStatisticsEvent.TriggerPlayerStatisticsEvents()"))),(0,n.kt)("p",null,"Note that although normally you wouldn't expect to get rewards in an Authenticate call, there are situations where rewards may be present. For instance, rewards may\xa0trigger on a global statistic which has incremented since the last time the user logged in. Or perhaps a cloud script on the server has modified the player's data in some way. In these cases, the rewards are returned in the authenticate call."),(0,n.kt)("h4",{id:"rewards-jsonformat"},"Rewards JSON\xa0format"),(0,n.kt)("p",null,"The general (quasi-json) output of a method that returns rewards is as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"experiencePoints - The user's current number of experience points"),(0,n.kt)("li",{parentName:"ul"},"xpCapped - Whether their XP is capped"),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"rewardDetails")," - complex structure that contains metadata about the rewards that have been triggered. This gives you the structured rewards as they've been configured in brainCloud.",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"milestones - \xa0array of milestones that were awarded (metadata)",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"rewards - rewards that are given to the player when this milestone is\xa0awarded",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"achievement"),(0,n.kt)("li",{parentName:"ul"},"experiencePoints"),(0,n.kt)("li",{parentName:"ul"},"currency"),(0,n.kt)("li",{parentName:"ul"},"globalStatistics"),(0,n.kt)("li",{parentName:"ul"},"statistics"))),(0,n.kt)("li",{parentName:"ul"},"questId - Either the quest id this milestone is attached to or null if it's a global (non-quest) milestone"),(0,n.kt)("li",{parentName:"ul"},"milestoneId - The id of the milestone"))),(0,n.kt)("li",{parentName:"ul"},"quests - array of quests that were awarded\xa0(metadata)",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"rewards - similar to the milestone structure above"),(0,n.kt)("li",{parentName:"ul"},"questId - The id of the quest"))),(0,n.kt)("li",{parentName:"ul"},"xp",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"experiencePoints -\xa0???")),(0,n.kt)("li",{parentName:"ul"},"experienceLevels - array of the experience levels that were awarded\xa0(metadata)",(0,n.kt)("ul",{parentName:"li"},(0,n.kt)("li",{parentName:"ul"},"level - the experience level"),(0,n.kt)("li",{parentName:"ul"},"reward - similar to the milestone structure above"))))))),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("strong",{parentName:"li"},"rewards")," - complex structure that contains the amalgamated rewards that have been triggered. For instance if two milestones are awarded which each pay out 50 gold currency, the rewards field will contain just one entry for currency of\xa0100 gold.")),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},'Note that the Authenticate API JSON puts all of the above information into a "rewards" element.')),(0,n.kt)("p",null,"Below is an example JSON return that rewards one milestone, one quest, one xp level, and some stats/xp/currency."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},'{\n "status": 200,\n "data": {\n  "experiencePoints": 1000,\n  "xpCapped": false,\n  "rewardDetails": {\n   "milestones": [\n    {\n     "rewards": {\n      "achievement": "testAchievement02"\n     },\n     "questId": "quest100",\n     "milestoneId": "2"\n    }\n   ],\n   "quests": [\n    {\n     "rewards": {\n      "experiencePoints": 1000,\n      "achievement": "testAchievement01"\n     },\n     "questId": "quest100"\n    }\n   ],\n   "xp": {\n    "experiencePoints": 1000,\n    "experienceLevels": [\n     {\n      "level": 2,\n      "reward": {\n       "currency": {\n        "gold": 1500\n       }\n      }\n     }\n    ]\n   }\n  },\n  "rewards": {\n   "experiencePoints": 1000,\n   "experienceLevels": [\n    2\n   ],\n   "milestonesAchieved": [\n    "2"\n   ],\n   "questsCompleted": [\n    "quest100"\n   ],\n   "playerAchievements": [\n    "testAchievement02",\n    "testAchievement01"\n   ],\n   "statistics": {\n    "completeQuest100": 1\n   },\n   "currency": {\n    "gold": 1555\n   }\n  },\n  "experienceLevel": 2,\n  "currency": {\n   "credits": {\n    "purchased": 0,\n    "balance": 90,\n    "consumed": 0,\n    "awarded": 90\n   },\n   "gold": {\n    "purchased": 0,\n    "balance": 8225,\n    "consumed": 0,\n    "awarded": 8225\n   }\n  },\n  "statistics": {\n   "completeQuest100": 1\n  }\n }\n}\n')),(0,n.kt)("h3",{id:"handling-rewards-in-the-rewardscallback-interface"},"Handling Rewards in the RewardsCallback interface"),(0,n.kt)("p",null,"An alternative to handling rewards directly in the API callback is to attach a rewards callback to the brainCloudClient. By attaching a rewards callback handler, you will receive callbacks whenever a reward is returned in any of the above API methods."),(0,n.kt)("h4",{id:"attaching-the-rewards-callback"},"Attaching The Rewards Callback"),(0,n.kt)("p",null,"See the ",(0,n.kt)("a",{parentName:"p",href:"/api/capi/client/registerrewardcallback"},"RegisterRewardCallback"),"\xa0and ",(0,n.kt)("a",{parentName:"p",href:"/api/capi/client/deregisterrewardcallback"},"DeregisterRewardCallback"),"\xa0methods in the BrainCloudClient class."),(0,n.kt)("h4",{id:"reward-callback-json-format"},"Reward Callback JSON format"),(0,n.kt)("p",null,"The Reward Callback JSON contains extra information that allows you to determine from which API call a reward has been issued. Note that the apiRewards member is an array - it's possible to receive multiple rewards in a single message bundle from the server."),(0,n.kt)("pre",null,(0,n.kt)("code",{parentName:"pre",className:"language-js"},'{\n  "apiRewards": [\n    "service": "playerStatistics",\n    "operation": "UPDATE",\n    "rewards": {\n      // the reward JSON information as defined above\n      // so for instance "rewards" and "rewardDetails"\n      // members would be at this level\n    } \n  ] \n}\n')))}p.isMDXComponent=!0}}]);