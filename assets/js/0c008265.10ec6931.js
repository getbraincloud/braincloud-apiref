"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[97602],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>g});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=a.createContext({}),c=function(e){var t=a.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},d=function(e){var t=c(e.components);return a.createElement(p.Provider,{value:t},e.children)},s="mdxType",u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,p=e.parentName,d=r(e,["components","mdxType","originalType","parentName"]),s=c(n),m=o,g=s["".concat(p,".").concat(m)]||s[m]||u[m]||i;return n?a.createElement(g,l(l({ref:t},d),{},{components:n})):a.createElement(g,l({ref:t},d))}));function g(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,l=new Array(i);l[0]=m;var r={};for(var p in t)hasOwnProperty.call(t,p)&&(r[p]=t[p]);r.originalType=e,r[s]="string"==typeof e?e:o,l[1]=r;for(var c=2;c<i;c++)l[c]=n[c];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},26428:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>l,default:()=>s,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var a=n(87462),o=(n(67294),n(3905));const i={title:"Authentication - Google (OpenID)",date:"2021-07-09"},l=void 0,r={unversionedId:"learn/portal-tutorials/authentication-google-openid/index",id:"learn/portal-tutorials/authentication-google-openid/index",title:"Authentication - Google (OpenID)",description:"This article elaborates on the basic steps of how to authenticate end-users with their Google credentials through OpenID Connect in a Unity Android app example. If you want to use Google Play Game to authenticate end-users with their Google credential, check out the article -- Authentication - Google (PlayGame) for detail.",source:"@site/docs/learn/5_portal-tutorials/authentication-google-openid/index.md",sourceDirName:"learn/5_portal-tutorials/authentication-google-openid",slug:"/learn/portal-tutorials/authentication-google-openid/",permalink:"/braincloud-apiref/learn/portal-tutorials/authentication-google-openid/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/learn/5_portal-tutorials/authentication-google-openid/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1672679892,formattedLastUpdatedAt:"Jan 2, 2023",frontMatter:{title:"Authentication - Google (OpenID)",date:"2021-07-09"},sidebar:"learnSidebar",previous:{title:"Authentication - Facebook",permalink:"/braincloud-apiref/learn/portal-tutorials/authentication-facebook/"},next:{title:"Authentication - Google (PlayGame)",permalink:"/braincloud-apiref/learn/portal-tutorials/authentication-google-playgame/"}},p={},c=[{value:"<strong>Prerequisites</strong>",id:"prerequisites",level:3},{value:"<strong>Step 1: Create an application on Unity editor</strong>",id:"step-1-create-an-application-on-unity-editor",level:3},{value:"<strong>Step 2: Create a Google project and configure it with OAuth 2.0 Client Credential</strong>",id:"step-2-create-a-google-project-and-configure-it-with-oauth-20-client-credential",level:3},{value:"<strong>Step 3: Configure Google client credential on brainCloud</strong>",id:"step-3-configure-google-client-credential-on-braincloud",level:3},{value:"<strong>Step 4: Final set up for Android app in Unity and build a test app</strong>",id:"step-4-final-set-up-for-android-app-in-unity-and-build-a-test-app",level:3},{value:"<strong>Step 5: Test</strong>",id:"step-5-test",level:3}],d={toc:c};function s(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,a.Z)({},d,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"This article elaborates on the basic steps of how to authenticate end-users with their Google credentials through ",(0,o.kt)("inlineCode",{parentName:"p"},"OpenID Connect")," in a Unity Android app example. If you want to use ",(0,o.kt)("inlineCode",{parentName:"p"},"Google Play Game")," to authenticate end-users with their Google credential, check out the ",(0,o.kt)("a",{parentName:"p",href:"http://help.getbraincloud.com/en/articles/5363283-authentication-google-playgame"},"article -- ",(0,o.kt)("inlineCode",{parentName:"a"},"Authentication - Google (PlayGame)"))," for detail."),(0,o.kt)("h3",{id:"prerequisites"},(0,o.kt)("strong",{parentName:"h3"},"Prerequisites")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"You have a Google account to create projects in GCP"),(0,o.kt)("li",{parentName:"ul"},"Your testing device with Android API level 19 and above")),(0,o.kt)("h3",{id:"step-1-create-an-application-on-unity-editor"},(0,o.kt)("strong",{parentName:"h3"},"Step 1: Create an application on Unity editor")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Open Unity hub and create a new project."),(0,o.kt)("li",{parentName:"ul"},"Download and import the latest ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/getbraincloud/braincloud-csharp/releases"},"brainCloud client Unity package")," to this project. Once imported the plugin correctly, you will find the brainCloud tab appears on the editor menu.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361191090/54fe2737fe8dbdf80062b782/image.png",alt:"image.png (1086\xd7446)"})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361191090/54fe2737fe8dbdf80062b782/image.png"}),"Download and import the latest ",(0,o.kt)("inlineCode",{parentName:"li"},"Google Sign-In Unity Plugin")," from repositories of ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/googlesamples"},"Google Samples"),". We will use it to require ",(0,o.kt)("inlineCode",{parentName:"li"},"server auth codes")," that will be passed to brainCloud method ",(0,o.kt)("a",{parentName:"li",href:"https://internal.braincloudservers.com/s3/apiref/index.html?csharp#capi-authentication-authenticategoogle"},(0,o.kt)("inlineCode",{parentName:"a"},"AuthenticateGoogle"))," in our code example.")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Some files under ",(0,o.kt)("inlineCode",{parentName:"p"},"PlayServiceResover")," might be obsolete, most likely, you will need to install the ",(0,o.kt)("inlineCode",{parentName:"p"},"unity-jar-resolver")," plugin from Google Samples repositories to update the ",(0,o.kt)("inlineCode",{parentName:"p"},"PlayServiceResover"),". Also, in case that you encounter duplicated ",(0,o.kt)("inlineCode",{parentName:"p"},"Task DLL")," file error, just go ahead to delete the one that was installed with the plugin located under ",(0,o.kt)("inlineCode",{parentName:"p"},"Asset->Paese->Plugins")," folder")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361231381/71eb2508c3d9feadd7517023/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361231381/71eb2508c3d9feadd7517023/image.png"}),"You should find these plugins imported folder under the asset.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361231553/115a857dda9b1c9dae5f45a7/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361231553/115a857dda9b1c9dae5f45a7/image.png"}),"Open ",(0,o.kt)("inlineCode",{parentName:"li"},"brainCloud setting")," from the tab, select or create a brainCloud back-end app linked to your project.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361231833/401996e1a0ae795afc816102/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361231833/401996e1a0ae795afc816102/image.png"}),"Create some UI elements to invoke initialize brainCloud and Google SignIn from your script.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/355325945/fe9c9f3d1a77cf66f997468a/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/355325945/fe9c9f3d1a77cf66f997468a/image.png"}),"Functions and the code behind the buttons are similar to below. Once end-users login into their Google account with Google Play Games by setting ",(0,o.kt)("inlineCode",{parentName:"li"},"UseGameSignIn")," as ",(0,o.kt)("inlineCode",{parentName:"li"},"false"),", so we can get their ",(0,o.kt)("inlineCode",{parentName:"li"},"userId")," via calling ",(0,o.kt)("inlineCode",{parentName:"li"},"GetUserId"),"() from success callback, and get their ",(0,o.kt)("inlineCode",{parentName:"li"},"server auth codes")," from ",(0,o.kt)("inlineCode",{parentName:"li"},"Google Sign in")," API, then pass them to brainCloud Google authentication method -- ",(0,o.kt)("inlineCode",{parentName:"li"},"AuthenticateGoogleOpenId"))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'    public void GoogleAPISignIn()\n    {\n        bcreturn.GetComponent<Text>().text = "Google sign in......";\n        GoogleSignIn.Configuration = configuration;\n        //GoogleSignIn.Configuration.UseGameSignIn = true;\n        GoogleSignIn.DefaultInstance.SignIn().ContinueWith(GoogleSinInCallback);\n    }\n\n    public void GoogleSinInCallback(Task<GoogleSignInUser> task)\n    {\n        if (task.IsFaulted)\n        {\n            using (IEnumerator<System.Exception> enumerator = task.Exception.InnerExceptions.GetEnumerator())\n            {\n                if (enumerator.MoveNext())\n                {\n                    GoogleSignIn.SignInException error = (GoogleSignIn.SignInException)enumerator.Current;\n                    bcreturn.GetComponent<Text>().text = "Task Exception Error: " + error.Status + " " + error.Message;\n                }\n                else\n                {\n                    bcreturn.GetComponent<Text>().text = "Task Unexpected Exception" + task.Exception;\n                }\n            }\n        }\n        else if (task.IsCanceled)\n        {\n            bcreturn.GetComponent<Text>().text = "Canceled";\n        }\n        else\n        {\n            //serverAuthCode = task.Result.AuthCode;\n            googleEmail = task.Result.Email;\n            idToken = task.Result.IdToken;\n\n            bcreturn.GetComponent<Text>().text = "Logged into google! \\n Email: " + googleEmail + " \\n IdToken: " + idToken;\n            channelid.GetComponent<InputField>().text = "[" + googleEmail + "]" + idToken;\n        }\n    }\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Finish the rest callbacks code in your script. Check the completed code from our GitHub Google Authentication project ",(0,o.kt)("a",{parentName:"li",href:"https://github.com/getbraincloud/examples-unity/tree/master/OpenIdGoogle"},"example")," for reference. (",(0,o.kt)("em",{parentName:"li"},"Note that, ",(0,o.kt)("inlineCode",{parentName:"em"},"GoogleSignInConfiguration")," requires ",(0,o.kt)("inlineCode",{parentName:"em"},"WebClientId")," to represent user in order to call Googel SignIn, we will need to config this in our code after the ",(0,o.kt)("inlineCode",{parentName:"em"},"client credential")," created from ",(0,o.kt)("inlineCode",{parentName:"em"},"Google Cloud Console")," later."),")"),(0,o.kt)("li",{parentName:"ul"},"Now, click ",(0,o.kt)("inlineCode",{parentName:"li"},"Build Settings")," from Unity ",(0,o.kt)("inlineCode",{parentName:"li"},"File")," tab, switch platform to ",(0,o.kt)("inlineCode",{parentName:"li"},"Android"),". Then, create a keystore from ",(0,o.kt)("inlineCode",{parentName:"li"},"Keystore Manager")," and save it to your local if you don't have one.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361233339/fc4363332baee44b9fac323a/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361233339/fc4363332baee44b9fac323a/image.png"}),"Set up your app ",(0,o.kt)("inlineCode",{parentName:"li"},"package name")," as well via ",(0,o.kt)("inlineCode",{parentName:"li"},"Player Settings"),".")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361233585/03e756cbc8e7a6679e34c796/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361233585/03e756cbc8e7a6679e34c796/image.png"}),"Now we can move to the next step to create a Google project.")),(0,o.kt)("h3",{id:"step-2-create-a-google-project-and-configure-it-with-oauth-20-client-credential"},(0,o.kt)("strong",{parentName:"h3"},"Step 2: Create a Google project and configure it with OAuth 2.0 Client Credential")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Before creating a project, let's generate a ",(0,o.kt)("inlineCode",{parentName:"li"},"SHA1")," fingerprint by using the ",(0,o.kt)("inlineCode",{parentName:"li"},"keystore")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"package name")," that we created from the previous step via the local terminal by using Java JDK ",(0,o.kt)("inlineCode",{parentName:"li"},"keytool")," command ",(0,o.kt)("inlineCode",{parentName:"li"},"keytool -exportcert -alias your-keystore-alia -keystore path-to-your-keystore-file -list -v"),". ( ",(0,o.kt)("em",{parentName:"li"},"if not set this command globally, to use this ",(0,o.kt)("inlineCode",{parentName:"em"},"keytool")," command you might need to cd into your java JDK home folder)"))),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361233828/7931db1cd0e1837f5d9857ae/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361233828/7931db1cd0e1837f5d9857ae/image.png"}),"Then, instead of going to Google Cloud Console to create a project and add auth client credential manually, we can go to the android-developer ",(0,o.kt)("inlineCode",{parentName:"li"},"Google Sign In")," page and create a project from there. (",(0,o.kt)("em",{parentName:"li"},"by utilizing this, a Google project and Android client ID for OAuth 2.0 created in just one click"),"), paste your Android app ",(0,o.kt)("inlineCode",{parentName:"li"},"package name")," and ",(0,o.kt)("inlineCode",{parentName:"li"},"SHA1")," fingerprint accordingly when asked and create the project.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361234143/f21c64af2b92b4da78c4aba3/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361234143/f21c64af2b92b4da78c4aba3/image.png"}),"Now, open Google Cloud Platform, you should be able to see both project and OAuth 2.0 Client IDs created for you.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361234774/7a56ac3704359cb8419011d0/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361234774/7a56ac3704359cb8419011d0/image.png"}),"Now, we finished the configurations for our project from GCP, note down Client ID and its secret of Web client credential, also, the ",(0,o.kt)("inlineCode",{parentName:"li"},"project number"),", we will need them to configure in brainCloud console. ",(0,o.kt)("em",{parentName:"li"},"(Note that you may already notice, the project number actually prefixed to Client ID)"))),(0,o.kt)("h3",{id:"step-3-configure-google-client-credential-on-braincloud"},(0,o.kt)("strong",{parentName:"h3"},"Step 3: Configure Google client credential on brainCloud")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Open your corresponding brainCloud app from brainCloud development portal, navigate to ",(0,o.kt)("strong",{parentName:"li"},"Design | Core App Info")," page.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361235476/c62e63024fdfcae04aced9b7/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361235476/c62e63024fdfcae04aced9b7/image.png"}),"Click ",(0,o.kt)("strong",{parentName:"li"},"Google")," under Configure Platforms and paste your ",(0,o.kt)("inlineCode",{parentName:"li"},"Client ID")," and its ",(0,o.kt)("inlineCode",{parentName:"li"},"secret of")," Web client credential into Google configs fields respectively.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361235890/d42bb6f584320d30ea0dd3f6/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361235890/d42bb6f584320d30ea0dd3f6/image.png"}),"Make sure the ",(0,o.kt)("inlineCode",{parentName:"li"},"Google Android")," platform is selected from the ",(0,o.kt)("strong",{parentName:"li"},"Design | Core App Info | Platforms")," page.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/355355598/9e21357f36fc027e3a2e2d4f/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/355355598/9e21357f36fc027e3a2e2d4f/image.png"}),"Now, we finished the settings from brainCloud, let us move to the next step to set up the client id to your code in Unity.")),(0,o.kt)("h3",{id:"step-4-final-set-up-for-android-app-in-unity-and-build-a-test-app"},(0,o.kt)("strong",{parentName:"h3"},"Step 4: Final set up for Android app in Unity and build a test app")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Referencing this Client ID as Google SignIn config in your code.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},'        configuration = new GoogleSignInConfiguration\n        {\n            WebClientId = "998140262691-eot4ico1t3qtb35ea1prbt9ilinekpnr.apps.googleusercontent.com",\n            RequestEmail = true,\n            RequestIdToken = true,\n            RequestAuthCode = true\n        };\n')),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Go to the ",(0,o.kt)("inlineCode",{parentName:"li"},"Build Settings")," screen to build APK for your test device.")),(0,o.kt)("h3",{id:"step-5-test"},(0,o.kt)("strong",{parentName:"h3"},"Step 5: Test")),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Install APK which was built from the previous step to your device and test it. You may be asked to give some permissions to your test app, grant it, and continue.")),(0,o.kt)("p",null,(0,o.kt)("img",{parentName:"p",src:"https://downloads.intercomcdn.com/i/o/361238988/94711012a481ce69b7dc295f/image.png",alt:null})),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://downloads.intercomcdn.com/i/o/361238988/94711012a481ce69b7dc295f/image.png"}),"Check the authenticated tester user from the brainCloud console.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"image.png (942\xd7225)",src:n(16357).Z,width:"870",height:"226"})))}s.isMDXComponent=!0},16357:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/image1-5a625b69aed6234a728269e0342fd435.png"}}]);