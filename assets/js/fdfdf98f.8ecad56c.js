"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[20716],{3905:(e,t,r)=>{r.d(t,{Zo:()=>c,kt:()=>f});var a=r(67294);function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,a)}return r}function o(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){n(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function p(e,t){if(null==e)return{};var r,a,n=function(e,t){if(null==e)return{};var r,a,n={},i=Object.keys(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||(n[r]=e[r]);return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)r=i[a],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}var l=a.createContext({}),s=function(e){var t=a.useContext(l),r=t;return e&&(r="function"==typeof e?e(t):o(o({},t),e)),r},c=function(e){var t=s(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var r=e.components,n=e.mdxType,i=e.originalType,l=e.parentName,c=p(e,["components","mdxType","originalType","parentName"]),u=s(r),d=n,f=u["".concat(l,".").concat(d)]||u[d]||m[d]||i;return r?a.createElement(f,o(o({ref:t},c),{},{components:r})):a.createElement(f,o({ref:t},c))}));function f(e,t){var r=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var i=r.length,o=new Array(i);o[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p[u]="string"==typeof e?e:n,o[1]=p;for(var s=2;s<i;s++)o[s]=r[s];return a.createElement.apply(null,o)}return a.createElement.apply(null,r)}d.displayName="MDXCreateElement"},52991:(e,t,r)=>{r.d(t,{Z:()=>g});var a=r(67294),n=r(86010),i=r(53438),o=r(39960),p=r(13919),l=r(95999);const s="cardContainer_fWXF",c="cardTitle_rnsV",u="cardDescription_PWke";function m(e){let{href:t,children:r}=e;return a.createElement(o.Z,{href:t,className:(0,n.Z)("card padding--lg",s)},r)}function d(e){let{href:t,icon:r,title:i,description:o}=e;return a.createElement(m,{href:t},a.createElement("h2",{className:(0,n.Z)("text--truncate",c),title:i},r," ",i),o&&a.createElement("p",{className:(0,n.Z)("text--truncate",u),title:o},o))}function f(e){let{item:t}=e;const r=(0,i.Wl)(t);return r?a.createElement(d,{href:r,icon:"\ud83d\uddc3\ufe0f",title:t.label,description:(0,l.I)({message:"{count} items",id:"theme.docs.DocCard.categoryDescription",description:"The default description for a category card in the generated index about how many items this category includes"},{count:t.items.length})}):null}function h(e){let{item:t}=e;const r=(0,p.Z)(t.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",n=(0,i.xz)(t.docId??void 0);return a.createElement(d,{href:t.href,icon:r,title:t.label,description:n?.description})}function y(e){let{item:t}=e;switch(t.type){case"link":return a.createElement(h,{item:t});case"category":return a.createElement(f,{item:t});default:throw new Error(`unknown item type ${JSON.stringify(t)}`)}}function v(e){let{className:t}=e;const r=(0,i.jA)();return a.createElement(g,{items:r.items,className:t})}function g(e){const{items:t,className:r}=e;if(!t)return a.createElement(v,e);const o=(0,i.MN)(t);return a.createElement("section",{className:(0,n.Z)("row",r)},o.map(((e,t)=>a.createElement("article",{key:t,className:"col col--6 margin-bottom--lg"},a.createElement(y,{item:e})))))}},83890:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>s,contentTitle:()=>p,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>c});var a=r(87462),n=(r(67294),r(3905)),i=r(52991);const o={},p="App Store",l={unversionedId:"api/client-api/appstore/index",id:"version-4.12.0/api/client-api/appstore/index",title:"App Store",description:"The AppStore Service provides access to Product / Pricing / Promotion features, as well as integrations with supported AppStores.",source:"@site/versioned_docs/version-4.12.0/api/2_client-api/appstore/index.md",sourceDirName:"api/2_client-api/appstore",slug:"/api/client-api/appstore/",permalink:"/braincloud-apiref/4.12.0/api/client-api/appstore/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/versioned_docs/version-4.12.0/api/2_client-api/appstore/index.md",tags:[],version:"4.12.0",lastUpdatedBy:"jasonl",lastUpdatedAt:1671154333,formattedLastUpdatedAt:"Dec 16, 2022",frontMatter:{},sidebar:"apiSidebar",previous:{title:"Client API",permalink:"/braincloud-apiref/4.12.0/api/client-api/"},next:{title:"FinalizePurchase",permalink:"/braincloud-apiref/4.12.0/api/client-api/appstore/finalizepurchase"}},s={},c=[{value:"API Summary",id:"api-summary",level:4},{value:"Verifying In-app Purchases",id:"verifying-in-app-purchases",level:4},{value:"Performing Two-part Purchases",id:"performing-two-part-purchases",level:4},{value:"Promotions",id:"promotions",level:4}],u={toc:c};function m(e){let{components:t,...r}=e;return(0,n.kt)("wrapper",(0,a.Z)({},u,r,{components:t,mdxType:"MDXLayout"}),(0,n.kt)("h1",{id:"app-store"},"App Store"),(0,n.kt)("p",null,"The ",(0,n.kt)("strong",{parentName:"p"},"AppStore Service")," provides access to ",(0,n.kt)("em",{parentName:"p"},"Product / Pricing / Promotion")," features, as well as integrations with supported AppStores."),(0,n.kt)("p",null,(0,n.kt)("em",{parentName:"p"},"This service replaces the deprecated")," ",(0,n.kt)("strong",{parentName:"p"},"Product Service")," ",(0,n.kt)("em",{parentName:"p"},"for purchases and product / pricing data. Currency operations have been moved to the new")," VirtualCurrency Service."),(0,n.kt)("p",null,"It includes APIs for:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Handling In-app Purchases (IAP)"),(0,n.kt)("li",{parentName:"ul"},"Querying Products and Promotions")),(0,n.kt)("h4",{id:"api-summary"},"API Summary"),(0,n.kt)("h4",{id:"verifying-in-app-purchases"},"Verifying In-app Purchases"),(0,n.kt)("p",null,"The specifics of processing in-app purchases from platform to platform vary slightly, but the overall flow is as follows:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},"Client app requests a list of products from brainCloud ( ",(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-getsalesinventory"},"GetSalesInventory")," )"),(0,n.kt)("li",{parentName:"ul"},"Client app requests the localized pricing details for the products from the AppStore"),(0,n.kt)("li",{parentName:"ul"},"Client app displays the products with prices to the user"),(0,n.kt)("li",{parentName:"ul"},"User chooses to purchase a product"),(0,n.kt)("li",{parentName:"ul"},"Client app invokes the purchase API from the AppStore.  AppStore performs the purchase, and sends back a receipt to the client"),(0,n.kt)("li",{parentName:"ul"},"Client sends the receipt to brainCloud for validation ( ",(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-verifypurchase"},"VerifyPurchase")," ).  brainCloud performs a back-channel verification of the receipt with the AppStore \u2013 and if all is good, makes any required changes to virtual currency balances")),(0,n.kt)("p",null,"The follow call requests the list of products for sale:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-getsalesinventory"},"GetSalesInventory")),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-getsalesinventorybycategory"},"GetSalesInventoryByCategory"))),(0,n.kt)("p",null,"This method is used to confirm store receipts:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-verifypurchase"},"VerifyPurchase")," - standardized receive verification for Apple, Google, Facebook and Steam purchases")),(0,n.kt)("h4",{id:"performing-two-part-purchases"},"Performing Two-part Purchases"),(0,n.kt)("p",null,"Some AppStores, like Steam, do a real-time two-part purchase. The following new API methods handle this requirement:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-startpurchase"},"StartPurchase")," - Generic version of start purchase."),(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-finalizepurchase"},"FinalizePurchase")," - Generic version of finalize purchase.")),(0,n.kt)("h4",{id:"promotions"},"Promotions"),(0,n.kt)("p",null,"In addition to the above purchase flows, the app can also query to see if any promotions are currently active (for display in banners, etc.), using the ",(0,n.kt)("a",{parentName:"p",href:"#capi-appstore-geteligiblepromotions"},"GetEligiblePromotions")," call \u2013 and can make manual adjustments to virtual currency balances."),(0,n.kt)("p",null,"The promotions API(s) are:"),(0,n.kt)("ul",null,(0,n.kt)("li",{parentName:"ul"},(0,n.kt)("a",{parentName:"li",href:"#capi-appstore-geteligiblepromotions"},"GetEligiblePromotions")," - Retrieves eligible promotions.")),(0,n.kt)(i.Z,{mdxType:"DocCardList"}))}m.isMDXComponent=!0}}]);