"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[15413],{3905:(t,e,a)=>{a.d(e,{Zo:()=>o,kt:()=>d});var n=a(67294);function i(t,e,a){return e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a,t}function r(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function c(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?r(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function l(t,e){if(null==t)return{};var a,n,i=function(t,e){if(null==t)return{};var a,n,i={},r=Object.keys(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||(i[a]=t[a]);return i}(t,e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);for(n=0;n<r.length;n++)a=r[n],e.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(t,a)&&(i[a]=t[a])}return i}var s=n.createContext({}),h=function(t){var e=n.useContext(s),a=e;return t&&(a="function"==typeof t?t(e):c(c({},e),t)),a},o=function(t){var e=h(t.components);return n.createElement(s.Provider,{value:e},t.children)},p="mdxType",u={inlineCode:"code",wrapper:function(t){var e=t.children;return n.createElement(n.Fragment,{},e)}},m=n.forwardRef((function(t,e){var a=t.components,i=t.mdxType,r=t.originalType,s=t.parentName,o=l(t,["components","mdxType","originalType","parentName"]),p=h(a),m=i,d=p["".concat(s,".").concat(m)]||p[m]||u[m]||r;return a?n.createElement(d,c(c({ref:e},o),{},{components:a})):n.createElement(d,c({ref:e},o))}));function d(t,e){var a=arguments,i=e&&e.mdxType;if("string"==typeof t||i){var r=a.length,c=new Array(r);c[0]=m;var l={};for(var s in e)hasOwnProperty.call(e,s)&&(l[s]=e[s]);l.originalType=t,l[p]="string"==typeof t?t:i,c[1]=l;for(var h=2;h<r;h++)c[h]=a[h];return n.createElement.apply(null,c)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},78312:(t,e,a)=>{a.r(e),a.d(e,{assets:()=>s,contentTitle:()=>c,default:()=>m,frontMatter:()=>r,metadata:()=>l,toc:()=>h});var n=a(87462),i=(a(67294),a(3905));const r={},c="Async Match",l={unversionedId:"api/capi/asyncmatch/index",id:"api/capi/asyncmatch/index",title:"Async Match",description:"Overview",source:"@site/docs/api/2_capi/asyncmatch/index.md",sourceDirName:"api/2_capi/asyncmatch",slug:"/api/capi/asyncmatch/",permalink:"/braincloud-apiref/api/capi/asyncmatch/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/api/2_capi/asyncmatch/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1671809255,formattedLastUpdatedAt:"Dec 23, 2022",frontMatter:{},sidebar:"apiSidebar",previous:{title:"VerifyPurchase",permalink:"/braincloud-apiref/api/capi/appstore/verifypurchase"},next:{title:"AbandonMatch",permalink:"/braincloud-apiref/api/capi/asyncmatch/abandonmatch"}},s={},h=[{value:"Overview",id:"overview",level:2},{value:"Match Lifecycle",id:"match-lifecycle",level:3},{value:"NOT_STARTED",id:"not_started",level:3},{value:"PENDING",id:"pending",level:3},{value:"COMPLETE",id:"complete",level:3},{value:"EXPIRED",id:"expired",level:3},{value:"Data Model",id:"data-model",level:3},{value:"Match Entity",id:"match-entity",level:3},{value:"MatchHistory Entity",id:"matchhistory-entity",level:3},{value:"Player Entity",id:"player-entity",level:3},{value:"API Summary",id:"api-summary",level:3},{value:"Match Management",id:"match-management",level:3},{value:"Turns",id:"turns",level:3},{value:"Match Data",id:"match-data",level:3}],o=(p="DocCardList",function(t){return console.warn("Component "+p+" was not imported, exported, or provided by MDXProvider as global scope"),(0,i.kt)("div",t)});var p;const u={toc:h};function m(t){let{components:e,...r}=t;return(0,i.kt)("wrapper",(0,n.Z)({},u,r,{components:e,mdxType:"MDXLayout"}),(0,i.kt)("h1",{id:"async-match"},"Async Match"),(0,i.kt)("h2",{id:"overview"},"Overview"),(0,i.kt)("p",null,"Many mobile games today feature a type of multiplayer game capability known as asynchronous or turn-based gaming. This is where player #1 would take a turn, then player #2 is notified that it is their turn (via push notification). Player #2 would then take their turn and player #1 is then notified it is again their turn and so on until the game is completed (think of playing a game of chess via mail)."),(0,i.kt)("p",null,"This page describes the design used to facilitate this type of multiplayer game within brainCloud."),(0,i.kt)("h3",{id:"match-lifecycle"},"Match Lifecycle"),(0,i.kt)("p",null,"An Async Match can exist in four states that define where it is in its lifecycle.  Certain operations are only supported in specific states."),(0,i.kt)("p",null,'The current state is returned in the "status" field of the match data.'),(0,i.kt)("h3",{id:"not_started"},"NOT_STARTED"),(0,i.kt)("p",null,"A match has been created but has not had any turns submitted.  A match in this state cannot be completed (status set to COMPLETE)."),(0,i.kt)("h3",{id:"pending"},"PENDING"),(0,i.kt)("p",null,"The match has had at least one turn submitted."),(0,i.kt)("h3",{id:"complete"},"COMPLETE"),(0,i.kt)("p",null,"A match that has been explicitly completed via the ",(0,i.kt)("a",{parentName:"p",href:"/api/capi/asyncmatch/completematch"},"CompleteMatch")," API. A match cannot be completed if its current status is NOT_STARTED."),(0,i.kt)("h3",{id:"expired"},"EXPIRED"),(0,i.kt)("p",null,"A match that has been explicitly abandoned via the ",(0,i.kt)("a",{parentName:"p",href:"/api/capi/asyncmatch/abandonmatch"},"AbandonMatch")," API. A match cannot be abandoned if its current status is COMPLETE."),(0,i.kt)("h3",{id:"data-model"},"Data Model"),(0,i.kt)("p",null,"The following diagram illustrates the data model implemented in brainCloud to support this feature:"),(0,i.kt)("p",null,(0,i.kt)("img",{alt:"Async Match Data Model",src:a(36916).Z,width:"1024",height:"688"})),(0,i.kt)("h3",{id:"match-entity"},"Match Entity"),(0,i.kt)("p",null,"The Match entity represents a single asynchronous match between two or more players (for example a single game of chess or tic-tac-toe)."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'The "gameId", "ownerId" and "matchId" uniquely identify a particular match, where "gameId" is the internal id of the game, "ownerId" is the internal player id of the player who created the match and "matchId" is an id that uniquely identifies the match within the context of a player.'),(0,i.kt)("li",{parentName:"ul"},'The "players" attribute represents a list of players that are part of the match. This consists of the match owner plus one or more opponents.'),(0,i.kt)("li",{parentName:"ul"},'The "status" attribute indicates the current status of the match. The status is made up of both an enumerated "status" (NOT_STARTED, PENDING, EXPIRED, COMPLETE) and an optional "currentPlayer" (which indicates whose "turn" it currently is).'),(0,i.kt)("li",{parentName:"ul"},'The "summary" attribute represents a client defined data structure that represents a high level summary of the match (i.e. current score).'),(0,i.kt)("li",{parentName:"ul"},'The "statistics" attribute represents a map of client defined statistics that are specific to a particular match.'),(0,i.kt)("li",{parentName:"ul"},'The "version" attribute is used to implement locking and concurrency of the match "state". If the current version stored in the database is greater then the version being submitted by a client, the submitted state will not be applied and an error will be returned.'),(0,i.kt)("li",{parentName:"ul"},'The "matchState" attribute is a client defined data structure that represents the actual current "state" of a particular match.'),(0,i.kt)("li",{parentName:"ul"},'The "createdAt" and "updatedAt" attributes are used to record when the match was created and when it was last modified/updated.')),(0,i.kt)("h3",{id:"matchhistory-entity"},"MatchHistory Entity"),(0,i.kt)("p",null,"The MatchHistory entity represents the turn-by-turn history of the state related to a particular match."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},'The "gameId", "ownerId" and "matchId" uniquely identify a particular match, where "gameId" is the internal id of the game, "ownerId" is the internal player id of the player who created the match and "matchId" is an id that uniquely identifies the match within the context of a player.'),(0,i.kt)("li",{parentName:"ul"},'The "turns" attribute is a list of MatchTurn instances (each one a snapshot of the game state over time).'),(0,i.kt)("li",{parentName:"ul"},'The "createdAt" attribute of a MatchTurn indicates when the state was added to the history. This allows us to see what the match state was over time.'),(0,i.kt)("li",{parentName:"ul"},'The "matchState" attribute of a MatchTurn is the client defined data structure that represents the actual "state" of a particular match.')),(0,i.kt)("h3",{id:"player-entity"},"Player Entity"),(0,i.kt)("p",null,'The Player entity represents the actual player. We are simply using the "lastLogin" attribute to identify those Player\'s that have been pre-created by the AsyncMatchService (by checking if the "lastLogin" field is NULL).'),(0,i.kt)("h3",{id:"api-summary"},"API Summary"),(0,i.kt)("h3",{id:"match-management"},"Match Management"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/creatematch"},"CreateMatch")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/creatematchwithinitialturn"},"CreateMatchWithInitialTurn")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/abandonmatch"},"AbandonMatch")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/completematch"},"CompleteMatch")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/deletematch"},"DeleteMatch"))),(0,i.kt)("h3",{id:"turns"},"Turns"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/submitturn"},"SubmitTurn"))),(0,i.kt)("h3",{id:"match-data"},"Match Data"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/readmatch"},"ReadMatch")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/readmatchhistory"},"ReadMatchHistory")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/updatematchsummarydata"},"UpdateMatchSummaryData")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/findmatches"},"FindMatches")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("a",{parentName:"li",href:"/api/capi/asyncmatch/findcompletematches"},"FindCompleteMatches"))),(0,i.kt)(o,{mdxType:"DocCardList"}))}m.isMDXComponent=!0},36916:(t,e,a)=>{a.d(e,{Z:()=>n});const n=a.p+"assets/images/asyncmatch-ed084ea3069ac4f055cbf5cc28fbb36c.png"}}]);