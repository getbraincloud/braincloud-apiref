"use strict";(self.webpackChunkdocusauruns_ts=self.webpackChunkdocusauruns_ts||[]).push([[19222],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>h});var a=n(67294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)n=s[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},d="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},c=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,u=o(e,["components","mdxType","originalType","parentName"]),d=p(n),c=r,h=d["".concat(l,".").concat(c)]||d[c]||m[c]||s;return n?a.createElement(h,i(i({ref:t},u),{},{components:n})):a.createElement(h,i({ref:t},u))}));function h(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var s=n.length,i=new Array(s);i[0]=c;var o={};for(var l in t)hasOwnProperty.call(t,l)&&(o[l]=t[l]);o.originalType=e,o[d]="string"==typeof e?e:r,i[1]=o;for(var p=2;p<s;p++)i[p]=n[p];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4406:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>d,frontMatter:()=>s,metadata:()=>o,toc:()=>p});var a=n(87462),r=(n(67294),n(3905));const s={title:"Making S2S API Calls from PostMan",date:"2018-11-16"},i=void 0,o={unversionedId:"learn/portal-tutorials/using-postman-with-s2s/index",id:"learn/portal-tutorials/using-postman-with-s2s/index",title:"Making S2S API Calls from PostMan",description:"brainCloud support two varieties of S2S calls: with and without explicitly-allocated sessions.",source:"@site/docs/learn/5_portal-tutorials/8_using-postman-with-s2s/index.md",sourceDirName:"learn/5_portal-tutorials/8_using-postman-with-s2s",slug:"/learn/portal-tutorials/using-postman-with-s2s/",permalink:"/braincloud-apiref/learn/portal-tutorials/using-postman-with-s2s/",draft:!1,editUrl:"https://github.com/getbraincloud/braincloud-apiref/tree/main/docs/learn/5_portal-tutorials/8_using-postman-with-s2s/index.md",tags:[],version:"current",lastUpdatedBy:"jasonl",lastUpdatedAt:1672679892,formattedLastUpdatedAt:"Jan 2, 2023",frontMatter:{title:"Making S2S API Calls from PostMan",date:"2018-11-16"},sidebar:"learnSidebar",previous:{title:"2FA for Team Members",permalink:"/braincloud-apiref/learn/portal-tutorials/two-factor-authentication-for-team-members/"},next:{title:"Email Integration - SendGrid",permalink:"/braincloud-apiref/learn/portal-tutorials/email-integration-sendgrid/"}},l={},p=[{value:"Installing PostMan",id:"installing-postman",level:2},{value:"Pre-requisite: Configuring S2S Servers",id:"pre-requisite-configuring-s2s-servers",level:2},{value:"Session-less S2S Requests",id:"session-less-s2s-requests",level:2},{value:"Session-based S2S Requests",id:"session-based-s2s-requests",level:2},{value:"Service and Operation Codes",id:"service-and-operation-codes",level:2}],u={toc:p};function d(e){let{components:t,...s}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,s,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"brainCloud support two varieties of S2S calls: with and without explicitly-allocated sessions."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"session-less"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"simpler, but less efficient"),(0,r.kt)("li",{parentName:"ul"},"a disposable ",(0,r.kt)("inlineCode",{parentName:"li"},"sessionId")," is automatically generated on the server (via authentication), and disposed of after the call"),(0,r.kt)("li",{parentName:"ul"},"this takes time and costs an additional API count"))),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"session-based"),(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},"faster ",(0,r.kt)("em",{parentName:"li"},"and")," less expensive!"),(0,r.kt)("li",{parentName:"ul"},"supports request bundling"),(0,r.kt)("li",{parentName:"ul"},"to use, you must first authenticate (similar to the Client API) to retrieve a sessionId, and then use that sessionId in future calls while incrementing the packetId associated with the message")))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"Note - the session-based S2S protocol, like the client protocol, supports the bundling of several API calls within a single HTTP request. In most circumstances it is more practical to combine the calls into a single cloud code script instead.")," "),(0,r.kt)("p",null,"Overall, the session-based S2S protocol is recommended for production applications, because it eliminates the redundant creation of disposable sessions. It performs better and costs you less! This tutorial will show you how to simulate both types of requests via Postman."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"installing-postman"},"Installing PostMan"),(0,r.kt)("p",null,"To install Postman, simply:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Download from\xa0",(0,r.kt)("a",{parentName:"li",href:"https://www.getpostman.com/"},"https://www.getpostman.com/")),(0,r.kt)("li",{parentName:"ul"},"Choose your platform, and complete the installation process")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"pre-requisite-configuring-s2s-servers"},"Pre-requisite: Configuring S2S Servers"),(0,r.kt)("p",null,"Incoming servers must be configured (i.e. declared) in the brainCloud dashboard before making S2S calls. This allows brainCloud to confirm that the requests are coming from a server that you own and aren't malicious."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Launch the ",(0,r.kt)("a",{parentName:"li",href:"https://portal.braincloudservers.com"},"brainCloud Portal")),(0,r.kt)("li",{parentName:"ul"},"Navigate to the\xa0",(0,r.kt)("strong",{parentName:"li"},"Design | Cloud Code | My Servers")," page.\xa0Click \xa0the ",(0,r.kt)("strong",{parentName:"li"},"[+New Server]")," button"),(0,r.kt)("li",{parentName:"ul"},'Give your server a name, like "EXAMPLE_SERVER"'),(0,r.kt)("li",{parentName:"ul"},"Entering IP ranges restricts access to requests coming from the specified network addresses. This is highly recommended for production apps! For now, you can leave the ranges blank. This will make all IP ranges acceptable."),(0,r.kt)("li",{parentName:"ul"},"Hit ",(0,r.kt)("strong",{parentName:"li"},"[Save]"),", and note your ",(0,r.kt)("em",{parentName:"li"},"server secret")," - you will use it later.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"session-less-s2s-requests"},"Session-less S2S Requests"),(0,r.kt)("p",null,"Session-less requests are simple. Each request is completely independent - no ",(0,r.kt)("inlineCode",{parentName:"p"},"sessionIds")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"packetIds")," to manage. This API is best when calls into brainCloud are few and far between."),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(40133).Z},(0,r.kt)("img",{src:n(91581).Z,width:"967",height:"570"}))),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"To simulate a session-less server request with Postman:")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Launch Postman"),(0,r.kt)("li",{parentName:"ul"},"Add a new Request"),(0,r.kt)("li",{parentName:"ul"},"Set the request type to ",(0,r.kt)("strong",{parentName:"li"},"POST")),(0,r.kt)("li",{parentName:"ul"},'Set the request URL to: "',(0,r.kt)("a",{parentName:"li",href:"https://sharedprod.braincloudservers.com/s2sdispatcher"},"https://sharedprod.braincloudservers.com/s2sdispatcher"),'"'),(0,r.kt)("li",{parentName:"ul"},"In the ",(0,r.kt)("strong",{parentName:"li"},"Body")," section of the request, choose ",(0,r.kt)("strong",{parentName:"li"},"raw")," and set the type to ",(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"JSON (application/json)"))),(0,r.kt)("li",{parentName:"ul"},"Copy this JSON into the body, setting the ",(0,r.kt)("inlineCode",{parentName:"li"},"appId"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"serverName"),"\xa0and ",(0,r.kt)("inlineCode",{parentName:"li"},"serverSecret")," appropriately for your app")),(0,r.kt)("p",null,"{",(0,r.kt)("br",{parentName:"p"}),"\n",'"appId":"12142",\n"serverName":"EXAMPLE_SERVER",\n"serverSecret":"b221c2a4-8df9-4937-8f9b-a95e4f71d5b6",\n"service":"globalApp",\n"operation":"READ_PROPERTIES",\n"data":{  '),(0,r.kt)("p",null,"   }\n}"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Select ",(0,r.kt)("strong",{parentName:"li"},"[Send]")),(0,r.kt)("li",{parentName:"ul"},"View the Response")),(0,r.kt)("p",null,"Unless you have added some properties, you will see an empty JSON response."),(0,r.kt)("p",null,"To change this, go to the\xa0",(0,r.kt)("strong",{parentName:"p"},"Design | Custom Config | Global Properties"),"\xa0page of the brainCloud Portal and configure a property or two - then run this request again. Voila!"),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"session-based-s2s-requests"},"Session-based S2S Requests"),(0,r.kt)("p",null,"Session-based requests require you to first request a ",(0,r.kt)("inlineCode",{parentName:"p"},"sessionId")," to use via the Authenticate operation. You then reference that ",(0,r.kt)("inlineCode",{parentName:"p"},"sessionId"),"\xa0in subsequent requests, along with an incrementing ",(0,r.kt)("inlineCode",{parentName:"p"},"packetId"),"."),(0,r.kt)("p",null,(0,r.kt)("em",{parentName:"p"},"First, we need to Authenticate to get a SessionId")),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"From Postman, Add a new Request"),(0,r.kt)("li",{parentName:"ul"},"Set the request type to ",(0,r.kt)("strong",{parentName:"li"},"POST")),(0,r.kt)("li",{parentName:"ul"},'Use the same request URL: "',(0,r.kt)("a",{parentName:"li",href:"https://sharedprod.braincloudservers.com/s2sdispatcher"},"https://sharedprod.braincloudservers.com/s2sdispatcher"),'"'),(0,r.kt)("li",{parentName:"ul"},"In the ",(0,r.kt)("strong",{parentName:"li"},"Body")," tab of the request, choose ",(0,r.kt)("strong",{parentName:"li"},"raw")," and set the type to \xa0",(0,r.kt)("strong",{parentName:"li"},(0,r.kt)("em",{parentName:"strong"},"JSON (application/json)"))),(0,r.kt)("li",{parentName:"ul"},"Copy this JSON into the body, setting the ",(0,r.kt)("inlineCode",{parentName:"li"},"appId"),", ",(0,r.kt)("inlineCode",{parentName:"li"},"serverName"),"\xa0and ",(0,r.kt)("inlineCode",{parentName:"li"},"serverSecret")," appropriately for your app"),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("strong",{parentName:"li"},"(in both places!)")),(0,r.kt)("li",{parentName:"ul"},"View the response, and save the ",(0,r.kt)("inlineCode",{parentName:"li"},"sessionId")," that is returned."),(0,r.kt)("li",{parentName:"ul"},"Now, make a second request, using that ",(0,r.kt)("inlineCode",{parentName:"li"},"sessionId")," and setting the\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"packetId")," to\xa0",(0,r.kt)("inlineCode",{parentName:"li"},"1")),(0,r.kt)("li",{parentName:"ul"},"For each subsequent request, be sure to increment the ",(0,r.kt)("inlineCode",{parentName:"li"},"packetId"),". Try this one:")),(0,r.kt)("p",null,"{",(0,r.kt)("br",{parentName:"p"}),"\n",'"packetId":0,\n"messages":','[\n{\n"appId":"12142",\n"service":"authenticationV2",\n"operation":"AUTHENTICATE",\n"data": {',(0,r.kt)("br",{parentName:"p"}),"\n",'"appId":"12142",\n"serverName":"EXAMPLE_SERVER",\n"serverSecret":"b221c2a4-8df9-4937-8f9b-a95e4f71d5b6"\n}\n}\n]',"\n}"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"View the response, and save the sessionId that is returned."),(0,r.kt)("li",{parentName:"ul"},"Now, make a second request, using that sessionId and setting the\xa0packedId to\xa01")),(0,r.kt)("p",null,'{\n"sessionId":"df5gelac0mhrpht31ffgtgatoe",\n"packetId":1,\n"messages":','[\n{\n"service":"globalEntity",\n"operation":"CREATE_SYSTEM_ENTITY",\n"data":{\n"entityType":"address",\n"timeToLive":null,\n"acl":{\n"other":1\n},\n"data":{\n"street":"1309 Carling"\n}\n}\n}\n]',"\n}"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"For each subsequent request, be sure to increment the ",(0,r.kt)("inlineCode",{parentName:"li"},"packetId"),". Try this one:")),(0,r.kt)("p",null,"{",(0,r.kt)("br",{parentName:"p"}),"\n",'"sessionId":"df5gelac0mhrpht31ffgtgatoe",\n"packetId":2,\n"messages":[',(0,r.kt)("br",{parentName:"p"}),"\n","{",(0,r.kt)("br",{parentName:"p"}),"\n",'"service":"globalEntity",\n"operation":"GET_LIST",\n"data":{',(0,r.kt)("br",{parentName:"p"}),"\n",'"where":{',(0,r.kt)("br",{parentName:"p"}),"\n",'"entityType":"address"\n},\n"orderBy":{  '),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'        },\n        "maxReturn":50\n     }\n  }\n')),(0,r.kt)("p",null,"   ]\n}"),(0,r.kt)("p",null,"So, you get the idea."),(0,r.kt)("p",null,"Important things to remember:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("em",{parentName:"li"},"Always")," increment the ",(0,r.kt)("inlineCode",{parentName:"li"},"packetId"),"\xa0- ",(0,r.kt)("em",{parentName:"li"},"except for identical retries"),". If you're retrying the same request because of a communications failure, you should keep the ",(0,r.kt)("inlineCode",{parentName:"li"},"packetId"),"\xa0the same (it helps the server to prevent duplicate operations from happening). If you got a response from the server though, successful or not, you should increment the packetId for you next request.")),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"service-and-operation-codes"},"Service and Operation Codes"),(0,r.kt)("p",null,"The API calls documented in the API Ref (",(0,r.kt)("a",{parentName:"p",href:"/api/s2s"},"/api/s2s"),") are mapped to discrete ",(0,r.kt)("em",{parentName:"p"},"Services")," and ",(0,r.kt)("em",{parentName:"p"},"Operations")," on the server."),(0,r.kt)("p",null,"The codes, together with operation-specific parameters (specified in the JSON ",(0,r.kt)("inlineCode",{parentName:"p"},"data"),"\xa0object) are used to send commands to the server."),(0,r.kt)("p",null,(0,r.kt)("a",{target:"_blank",href:n(32911).Z},(0,r.kt)("img",{src:n(4696).Z,width:"752",height:"462"}))),(0,r.kt)("p",null,"Only the API Calls in the S2S section of the API Ref can be used for S2S calls."))}d.isMDXComponent=!0},40133:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/2018-11-17_17-16-51-712a7f7cc6df12c341d22e1a2ae3bb61.png"},32911:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/files/APIRef-e027c5cd47f1432ea2cb1a1c9d64be1a.png"},91581:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/2018-11-17_17-16-51-712a7f7cc6df12c341d22e1a2ae3bb61.png"},4696:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/APIRef-e027c5cd47f1432ea2cb1a1c9d64be1a.png"}}]);